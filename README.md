# undelivered-message-processor

A small script to process SMTP delivery reports

## Description

This small script connects to an IMAP4 mailbox, and looks for the unread messages containing a DSN.

Delivery Status Notifications are MIME parts generated by SMTP server to indicate message delivery events.

See RFC 3664 for more details <https://datatracker.ietf.org/doc/html/rfc3464>

The program reads IMAP settings from a configuration file conforming to INI syntax.

The output is a CSV file.

The goal of the script is to synthetize into a simple single report the many returns received when mailing multiple adresses to process undelivered or delayed messages.

## Limitation

Current version only manages DSN for a single recipient.
RFC allows for multiple recipients to be addressed by a single DSN.
This case is rare and not managed by current version of this script.

## Usage

```
ump.py [-h] [-c CONFIG] [-o OUTPUT]
```

Optional arguments:

* `-h`, `--help`                 show the help message and exit
* `-c CONFIG`, `--config CONFIG` configuration file
*  `-o OUTPUT`, `--output OUTPUT` destination file

## Configuration

```ini
[imap]
server=YourServerFQDN
port=YourServerPort
login=YourLoginHere
password=YourPasswordHere
folder=INBOX
```

## Installation

1. Checkout the project
2. install dependencies (in a `VirtualEnv` preferably)
3. customize the configuration file
4. run


##Â Dependencies

The following Python3 modules are required:

* `argparse`
* `configparser`
* `csv`
* `email`
* `imaplib2`
* `logging`
* `rich` 

Most of them should be pre-installed with your Python3 distribution.
